# C++基础

## C++程序内存分布

分为几个区域，栈区，堆区，全局区，常量区，代码区。

栈区用于存放函数的临时数据结构的区域，存放运行时为函数定义的函数参数，局部变量，返回值，返回地址等，栈区一般较小，在程序运行时由编译器来控制，不需要的时候就释放掉，并且栈空间的分配指令是内置于计算机指令集的，效率会很高。

堆区一般是程序员自己分配， 用于存放程序运行时需要的变量，比较灵活，一般用new malloc，在不需要的时候需要程序员自己去delete或free掉这块空间，如果操作不当，例如重复释放，未释放可能会导致内存泄漏的情况出现，当频繁的分配大小不同的内存时，可能会存在大量内存碎片。并且堆区的大小是可以根据需要去扩容的。如果未定义释放，在程序结束时会自动释放内存空间

全局区用于存放全局变量和静态变量，在C中还分初始化的全局区域和未初始化的全局区域，C++的就共用了，未初始化的内存空间可以用void指针来访问，程序结束自动释放。

常量区一般存放常量数据，如常量字符串，数值，或者const全局变量等，const局部变量不在常量区，他一般在栈区，因为const局部变量一般是为了这个值不被改变。

代码区，用于存放函数的的二进制代码

全局变量在一个文件定义了其他文件都能用，静态全局变量不行，如果不同文件定义了同一个全局变量会报错mutidefinition，静态变量在程序运行时初始化一遍，每次使用都是之前定义的变量，就算是静态局部变量也是如此。

## new和malloc的区别

new在分配空间时会返回指向对象的指针，会调用对象的构造函数，delete时会调用对象的析构函数，而malloc在分配空间时，并不进行初始化，只是单纯的分配地址空间，返回的是一个void*，还需要对其进行初始化，释放时调用free。

new是c++操作符，malloc是C中的函数，

new在实现上实际调用了malloc，只是在其基础上，还对对象进行初始化

## 指针和引用的区别

